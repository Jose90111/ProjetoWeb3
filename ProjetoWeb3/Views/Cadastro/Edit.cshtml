@model ProjetoImg.Models.Cad_cliente

@{
    ViewData["Title"] = "Editar Cliente";
}

<h2>Editar Cliente</h2>

<form asp-action="Edit" enctype="multipart/form-data" method="post">
    <input type="hidden" asp-for="ID" />

    <!-- Foto Atual no Topo -->
    <div class="form-group">
        <label>Foto Atual</label>
        <img id="current-photo"
             src="data:image/png;base64,@(Model.Foto != null ? Convert.ToBase64String(Model.Foto) : "")"
             alt="Foto do Cliente"
             width="150"
             height="150" /><br />
    </div>

    <!-- Outros campos do formulário -->
    <div class="form-group">
        <label asp-for="Nome"></label>
        <input asp-for="Nome" class="form-control" />
        <span asp-validation-for="Nome" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="CPF"></label>
        <input asp-for="CPF" class="form-control" />
        <span asp-validation-for="CPF" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Email"></label>
        <input asp-for="Email" class="form-control" />
        <span asp-validation-for="Email" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="DataNascimento"></label>
        <input asp-for="DataNascimento" class="form-control" type="date" />
        <span asp-validation-for="DataNascimento" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Sexo"></label>
        <select asp-for="Sexo" class="form-control">
            <option value="">Selecione</option>
            <option value="Masculino">Masculino</option>
            <option value="Feminino">Feminino</option>
        </select>
        <span asp-validation-for="Sexo" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Logradouro"></label>
        <input asp-for="Logradouro" class="form-control" />
        <span asp-validation-for="Logradouro" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Numero"></label>
        <input asp-for="Numero" class="form-control" />
        <span asp-validation-for="Numero" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Complemento"></label>
        <input asp-for="Complemento" class="form-control" />
        <span asp-validation-for="Complemento" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Bairro"></label>
        <input asp-for="Bairro" class="form-control" />
        <span asp-validation-for="Bairro" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Cidade"></label>
        <input asp-for="Cidade" class="form-control" />
        <span asp-validation-for="Cidade" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Estado"></label>
        <input asp-for="Estado" class="form-control" />
        <span asp-validation-for="Estado" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="CEP"></label>
        <input asp-for="CEP" class="form-control" />
        <span asp-validation-for="CEP" class="text-danger"></span>
    </div>

    <!-- Pré-visualização da nova imagem -->
    <div class="form-group">
        <label>Pré-visualização da Nova Foto</label>
        <img id="preview-photo"
             src="#"
             alt="Pré-visualização da Nova Foto"
             width="150"
             height="150"
             style="display:none;" /><br />
    </div>

    <!-- Campo para anexar nova foto -->
    <div class="form-group">
        <label>Alterar Foto</label>
        <input type="file" name="foto" class="form-control" id="file-input" />
    </div>
    <div class="form-group">
        
        <button type="submit" class="btn btn-primary">Salvar</button>
        <a asp-action="Index" class="btn btn-secondary">Voltar</a>
        <a asp-action="Index" class="btn btn-danger">Cancelar</a>
        </br>
        </br>
    </div>

    

    <!-- Script para pré-visualização -->
    <script>
        document.getElementById("file-input").addEventListener("change", function (event) {
            const preview = document.getElementById("preview-photo"); // Pré-visualização
            const file = event.target.files[0]; // Arquivo anexado

            if (file) {
                const reader = new FileReader(); // Lê o arquivo
                reader.onload = function (e) {
                    preview.src = e.target.result; // Define o src da imagem como base64
                    preview.style.display = "block"; // Torna a pré-visualização visível
                };
                reader.readAsDataURL(file); // Lê o arquivo como Data URL (base64)
            } else {
                preview.src = "#";
                preview.style.display = "none"; // Esconde a pré-visualização se não houver arquivo
            }
        });
    </script>

</form>